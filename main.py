import telebot

TOKEN = '7665034171:AAGdER8_Q-JJgUhyPFDhcziHaWoWdEg8sSw'
bot = telebot.TeleBot(TOKEN)

# –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ç–µ—Å—Ç–∞
questions = [
    {
        "question": "–ö–∞–∫–æ–π –ª—é–±–∏–º—ã–π —Ü–≤–µ—Ç —É —Å–æ–ª–Ω—ã—à–∫–∏ –∑–∞–π–∫–∏?",
        "options": ["–ö—Ä–∞—Å–Ω—ã–π", "–°–∏–Ω–∏–π", "–ó–µ–ª–µ–Ω—ã–π", "–ë–µ–ª—ã–π"],
        "correct": 3
    },
    {
        "question": "–ö–∞–∫–æ–µ –±–ª—é–¥–æ —Ü–≤–µ—Ç–æ—á–µ–∫ –ª—é–±–∏—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
        "options": ["–ü–∏—Ü—Ü–∞", "–†–æ–ª–ª—ã", "–ü–∞—Å—Ç–∞", "–ë–æ—Ä—â"],
        "correct": 1
    },
    {
        "question": "–ö–∞–∫–æ–π –ª—é–±–∏–º—ã–π —Å–µ—Ä–∏–∞–ª —É –î–∏–∞–Ω–æ—á–∫–∏?",
        "options": ["–ò–≥—Ä–∞ –ø—Ä–µ—Å—Ç–æ–ª–æ–≤", "–î—Ä—É–∑—å—è", "–ù–∏–∫–∞–∫–æ–π", "–û—á–µ–Ω—å —Å—Ç—Ä–∞–Ω–Ω—ã–µ –¥–µ–ª–∞"],
        "correct": 2
    },
    {
        "question": "–ö–∞–∫–æ–π —É —Å–æ–ª–Ω—ã—à–∫–∞ —Ä–∞–∑–º–µ—Ä –æ–±—É–≤–∏?",
        "options": ["37", "38", "39", "40"],
        "correct": 2
    },
    {
        "question": "–ß—Ç–æ —Ç–≤–æ—è –ª—é–±–∏–º–∞—è –≤—ã–±–µ—Ä–µ—Ç –Ω–∞ —É–∂–∏–Ω?",
        "options": ["–°—Ç–µ–π–∫", "–°–∞–ª–∞—Ç", "–ñ–∞—Ä–µ–Ω–∞—è –∫–∞—Ä—Ç–æ—à–∫–∞", "–ö–æ—Ç–ª–µ—Ç—ã"],
        "correct": 0
    },
    {
        "question": "–ö–æ–≥–¥–∞ –º—ã –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å?",
        "options": ["28 —Ñ–µ–≤—Ä–∞–ª—è", "25 —Ñ–µ–≤—Ä–∞–ª—è", "12 —Ñ–µ–≤—Ä–∞–ª—è", "30 —è–Ω–≤–∞—Ä—è"],
        "correct": 0
    },
    {
        "question": "–ö–æ–≥–¥–∞ –º—ã –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –ø–æ—Ü–µ–ª–æ–≤–∞–ª–∏—Å—å?",
        "options": ["28 —Ñ–µ–≤—Ä–∞–ª—è", "19 –∞–ø—Ä–µ–ª—è", "20 –∞–ø—Ä–µ–ª—è", "30 —Ñ–µ–≤—Ä–∞–ª—è"],
        "correct": 1
    },
    {
        "question": "–ö—Ç–æ —á–∞—â–µ —É—Å—Ç—É–ø–∞–µ—Ç –≤ —Å—Å–æ—Ä–µ?",
        "options": ["–°–æ–ª–Ω—ã—à–∫–æ-–∑–∞–π–∫–∞", "–ú–µ–¥–≤–µ–∂–µ–Ω–æ–∫", "–ù–∏–∫—Ç–æ", "–ú—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å—Å–æ—Ä–∏–º—Å—è"],
        "correct": 1
    },
    {
        "question": "–ì–¥–µ –æ–Ω–∞ –º–µ—á—Ç–∞–µ—Ç –ø–æ–±—ã–≤–∞—Ç—å?",
        "options": ["–ê–Ω–∞–ø–∞", "–¢–µ—Ä–º—ã –ù–ö", "–ü–∞—Ä–∏–∂", "–ë–∞–ª–∏"],
        "correct": 3
    },
    {
        "question": "–ß—Ç–æ —Å–æ–ª–Ω—ã—à–∫–æ –∑–∞–π–∫–∞ –ª—é–±–∏—Ç –¥–µ–ª–∞—Ç—å –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Å –†—É–∑–µ–ª—å—á–∏–∫–æ–º?",
        "options": ["–¢—Ä–∞—Ç–∏—Ç—å –µ–≥–æ –¥–µ–Ω—å–≥–∏", "–ö—É—Å–∞—Ç—å", "–ù—é—Ö–∞—Ç—å", "–ò–∑–¥–µ–≤–∞—Ç—å—Å—è"],
        "correct": 1
    },
    {
        "question": "–ß—Ç–æ –î–∏–∞–Ω–æ—á–∫—É –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –±–µ—Å–∏—Ç?",
        "options": ["–ë–µ—Å–ø–æ—Ä—è–¥–æ–∫", "–¢—É–ø—ã–µ —à—É—Ç–∫–∏", "–î—Ä—É–≥–∏–µ –¥–µ–≤–æ—á–∫–∏", "–î–æ—Ç–∞"],
        "correct": 2
    },
    {
        "question": "–ö–∞–∫–æ–µ –Ω–∞—à–µ –ø–µ—Ä–≤–æ–µ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ —Ñ–æ—Ç–æ?",
        "options": ["–í –∫–∞—Ñ–µ –Ω–∞ –±–∞—É–º–∞–Ω–∞", "–ù–∞ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫–µ", "–ù–∞ –∫–∞—Ç–∞–º–∞—Ä–∞–Ω–µ", "–í 309"],
        "correct": 2
    },
    {
        "question": "–õ—é–±–∏–º—ã–µ —Ü–≤–µ—Ç–æ—á–∫–∏ –î–∏–∞–Ω–æ—á–∫–∏?",
        "options": ["–ü–∏–æ–Ω—ã", "–†–æ–∑—ã", "–ü–∏–æ–Ω—ã –∏ —Ä–æ–∑—ã", "–†–æ–º–∞—à–∫–∏"],
        "correct": 2
    },
    {
        "question": "–ö–∞–∫–∏–µ –Ω–µ–ª—é–±–∏–º—ã–µ —Ü–≤–µ—Ç–æ—á–∫–∏ —É –î–∏–∞–Ω–æ—á–∫–∏?",
        "options": ["–õ–∏–ª–∏—è", "–•—Ä–∏–∑–∞–µ–Ω—Ç–µ–º–∞", "–î–∏–∞–Ω—Ç—É—Å—ã", "–ì–æ—Ä—Ç–µ–Ω–∑–∏—è"],
        "correct": 0
    },
    {
        "question": "–ö–∞–∫–æ–π –ø–æ–¥–∞—Ä–æ–∫ –î–∏–∞–Ω–æ—á–∫–∞ –º–µ—á—Ç–∞–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –≤ —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏?",
        "options": ["–ü–æ—Ä—à", "–ö–∞—Ä—Ç—å–µ", "–ö–≤–∞—Ä—Ç–∏—Ä—É", "–ë–µ–∑–ª–∏–º–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –†—É–∑–µ–ª—è"],
        "correct": 0
    }
]

# –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
user_answers = {}


# –ù–∞—á–∞–ª–æ —Ç–µ—Å—Ç–∞
@bot.message_handler(commands=['start', 'test'])
def start_test(message):
    chat_id = message.chat.id

    # –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    if message.text == "/start":
        bot.send_message(
            chat_id,
            "–ü—Ä–∏–≤–µ—Ç, —Å–∞–º—ã–π –ª—É—á—à–∏–π –†—É–∑–µ–ª—å –Ω–∞ —Å–≤–µ—Ç–µ! üíñ\n\n"
            "–î–∏–∞–Ω–æ—á–∫–µ —Å–Ω–æ–≤–∞ –ø—Ä–∏—à–ª–∞ –∫—Ä—É—Ç–∞—è –∏–¥–µ—è –≤ –µ—ë –≥–æ–ª–æ–≤—É, –∏ —Ç–µ–ø–µ—Ä—å —Ç–µ–±–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–¥–æ –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç. "
            "–ï—Å–ª–∏ —Ç—ã –Ω–µ –ø—Ä–æ–π–¥—ë—à—å, –∑–Ω–∞—á–∏—Ç –µ—ë –Ω–µ –ª—é–±–∏—à—å! üò±\n\n"
            "–ù–∞–∂–º–∏ /test, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å. –≠—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å! üöÄ"
        )
        return

    # –ù–∞—á–∞–ª–æ —Ç–µ—Å—Ç–∞
    user_answers[chat_id] = {"current_question": 0, "score": 0}  # –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
    send_question(chat_id)


# –û—Ç–ø—Ä–∞–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞
def send_question(chat_id):
    user_data = user_answers.get(chat_id)
    if user_data is None:
        bot.send_message(chat_id, "–í–≤–µ–¥–∏—Ç–µ /start, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç!")
        return

    current_index = user_data["current_question"]

    # –ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å, –ø–æ–¥–≤–µ—Å—Ç–∏ –∏—Ç–æ–≥–∏
    if current_index >= len(questions):
        bot.send_message(chat_id, f"–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à—ë–Ω! –¢—ã –Ω–∞–±—Ä–∞–ª {user_data['score']} –∏–∑ {len(questions)} –±–∞–ª–ª–æ–≤!")
        user_answers.pop(chat_id)  # –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
        return

    question = questions[current_index]
    markup = telebot.types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
    for option in question["options"]:
        markup.add(option)

    bot.send_message(chat_id, question["question"], reply_markup=markup)


# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞
@bot.message_handler(func=lambda message: message.chat.id in user_answers)
def handle_answer(message):
    chat_id = message.chat.id
    user_data = user_answers[chat_id]
    current_index = user_data["current_question"]
    question = questions[current_index]

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–≤–µ—Ç
    if message.text == question["options"][question["correct"]]:
        user_data["score"] += 1  # –î–æ–±–∞–≤–∏—Ç—å –±–∞–ª–ª –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç

    # –ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É
    user_data["current_question"] += 1
    send_question(chat_id)


# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
bot.polling()
